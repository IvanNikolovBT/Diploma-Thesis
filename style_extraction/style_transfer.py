import sys
import os
import pandas as pd
import requests
PROJECT_ROOT = os.path.abspath(os.path.join(os.path.dirname(__file__), ".."))
sys.path.insert(0, PROJECT_ROOT)
from poetry_DB import PoetryDB
import time
from tqdm import tqdm
import datetime
import boto3
import json
class StyleTransfer:
    
    def __init__(self):
        self.system_prompt={"role": "system","content": ("<s>[INST]–†–∞–∑–≥–æ–≤–æ—Ä –ø–æ–º–µ—ì—É —ô—É–±–æ–ø–∏—Ç–µ–Ω –∫–æ—Ä–∏—Å–Ω–∏–∫ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫ –∑–∞ –µ–∫—Å—Ç—Ä–∞–∫—Ü–∏—ò–∞ –Ω–∞ —Å—Ç–∏–ª –º–∞–∫–µ–¥–æ–Ω—Å–∫–∞ –ø–æ–µ–∑–∏—ò–∞. –ê—Å–∏—Å—Ç–µ–Ω—Ç–æ—Ç –¥–∞–≤–∞ –∫–æ—Ä–∏—Å–Ω–∏, –¥–µ—Ç–∞–ª–Ω–∏ –∏ —ô—É–±–µ–∑–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ –ø—Ä–∞—à–∞—ö–∞—Ç–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç.[/INST]</s>.")}
        self.styles_map = {
        "–§–∏–≥—É—Ä–∞—Ç–∏–≤–µ–Ω —ò–∞–∑–∏–∫": "–§–∏–≥—É—Ä–∞—Ç–∏–≤–µ–Ω —ò–∞–∑–∏–∫ ‚Äì —É–ø–æ—Ç—Ä–µ–±–∞ –Ω–∞ –º–µ—Ç–∞—Ñ–æ—Ä–∏, —Å–∏–º–±–æ–ª–∏ –∏–ª–∏ –∞–ª–µ–≥–æ—Ä–∏–∏ –∑–∞ –¥–∞ —Å–µ –ø—Ä–µ–Ω–µ—Å–µ –∑–Ω–∞—á–µ—ö–µ –∫–æ–µ –Ω–µ –µ –±—É–∫–≤–∞–ª–Ω–æ.",
        "–°–∞—Ä–∫–∞–∑–∞–º": "–°–∞—Ä–∫–∞–∑–∞–º ‚Äì –∏–∑—Ä–∞–∑—É–≤–∞—ö–µ –Ω–∞ —Å–ø—Ä–æ—Ç–∏–≤–Ω–æ—Ç–æ –æ–¥ –æ–Ω–∞ —à—Ç–æ –Ω–∞–≤–∏—Å—Ç–∏–Ω–∞ —Å–µ –º–∏—Å–ª–∏, —Å–æ —Ü–µ–ª –∏—Ä–æ–Ω–∏—ò–∞ –∏–ª–∏ –ø–æ—Ç—Å–º–µ–≤.",
        "–§—Ä–∞–≥–º–µ–Ω—Ç –æ–¥ —Ä–µ—á–µ–Ω–∏—Ü–∞": "–§—Ä–∞–≥–º–µ–Ω—Ç –æ–¥ —Ä–µ—á–µ–Ω–∏—Ü–∞ ‚Äì –Ω–µ–¥–æ–≤—Ä—à–µ–Ω–∞ —Ä–µ—á–µ–Ω–∏—Ü–∞ –±–µ–∑ —Å–∏—Ç–µ –Ω–µ–æ–ø—Ö–æ–¥–Ω–∏ –≥—Ä–∞–º–∞—Ç–∏—á–∫–∏ –¥–µ–ª–æ–≤–∏.",
        "–î–æ–ª–≥–∞ —Ä–µ—á–µ–Ω–∏—Ü–∞ (run-on)": "–î–æ–ª–≥–∞ —Ä–µ—á–µ–Ω–∏—Ü–∞ (run-on) ‚Äì —Ä–µ—á–µ–Ω–∏—Ü–∞ —Å–æ—Å—Ç–∞–≤–µ–Ω–∞ –æ–¥ –ø–æ–≤–µ—ú–µ –º–∏—Å–ª–∏ –±–µ–∑ –ø—Ä–∞–≤–∏–ª–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—É–Ω–∫—Ü–∏—ò–∞ –∏–ª–∏ —Å–≤—Ä–∑–Ω–∏—Ü–∏.",
        "–ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å": "–ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å ‚Äì –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –≤–æ –∫–æ—ò–∞ –ø–æ–¥–º–µ—Ç–æ—Ç —ò–∞ –≤—Ä—à–∏ –¥–µ—ò—Å—Ç–≤–æ—Ç–æ (–Ω–∞ –ø—Ä. ‚Äû–à–∞—Å –≥–æ –ø–∏—à—É–≤–∞–º –ø–∏—Å–º–æ—Ç–æ‚Äú).",
        "–ü–∞—Å–∏–≤–µ–Ω –≥–ª–∞—Å": "–ü–∞—Å–∏–≤–µ–Ω –≥–ª–∞—Å ‚Äì –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –≤–æ –∫–æ—ò–∞ –ø–æ–¥–º–µ—Ç–æ—Ç —ò–∞ –ø—Ä–∏–º–∞ –¥–µ—ò—Å—Ç–≤–æ—Ç–æ (–Ω–∞ –ø—Ä. ‚Äû–ü–∏—Å–º–æ—Ç–æ –µ –Ω–∞–ø–∏—à–∞–Ω–æ –æ–¥ –º–µ–Ω–µ‚Äú).",
        "–ì—Ä–µ—à–∫–∏ –≤–æ —Å–æ–≥–ª–∞—Å—É–≤–∞—ö–µ": "–ì—Ä–µ—à–∫–∏ –≤–æ —Å–æ–≥–ª–∞—Å—É–≤–∞—ö–µ ‚Äì –Ω–µ—Å–æ–≥–ª–∞—Å—É–≤–∞—ö–µ –ø–æ–º–µ—ì—É –ø–æ–¥–º–µ—Ç –∏ –ø—Ä–∏—Ä–æ–∫ –≤–æ –±—Ä–æ—ò, —Ä–æ–¥ –∏–ª–∏ –ª–∏—Ü–µ.",
        "–ú–∞—à–∫–∏ –∑–∞–º–µ–Ω–∫–∏": "–ú–∞—à–∫–∏ –∑–∞–º–µ–Ω–∫–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–∞—Ç –∑–∞ –∑–∞–º–µ–Ω–∞ –Ω–∞ –º–∞—à–∫–∏ –∏–º–µ–Ω–∫–∏ (—Ç–æ—ò, –Ω–µ–≥–æ, –Ω–µ–≥–æ–≤).",
        "–ñ–µ–Ω—Å–∫–∏ –∑–∞–º–µ–Ω–∫–∏": "–ñ–µ–Ω—Å–∫–∏ –∑–∞–º–µ–Ω–∫–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–∞—Ç –∑–∞ –∑–∞–º–µ–Ω–∞ –Ω–∞ –∂–µ–Ω—Å–∫–∏ –∏–º–µ–Ω–∫–∏ (—Ç–∞–∞, –Ω–µ–∞, –Ω–µ—ò–∑–∏–Ω).",
        "–ü—Ä–æ—Å–æ—Ü–∏—ò–∞–ª–Ω–æ –æ–¥–Ω–µ—Å—É–≤–∞—ö–µ": "–ü—Ä–æ—Å–æ—Ü–∏—ò–∞–ª–Ω–æ –æ–¥–Ω–µ—Å—É–≤–∞—ö–µ ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò –ø–æ–∫–∞–∂—É–≤–∞ —Å–æ—Ä–∞–±–æ—Ç–∫–∞, –ø–æ–º–æ—à –∏–ª–∏ –µ–º–ø–∞—Ç–∏—ò–∞.",
        "–ê–Ω—Ç–∏—Å–æ—Ü–∏—ò–∞–ª–Ω–æ –æ–¥–Ω–µ—Å—É–≤–∞—ö–µ": "–ê–Ω—Ç–∏—Å–æ—Ü–∏—ò–∞–ª–Ω–æ –æ–¥–Ω–µ—Å—É–≤–∞—ö–µ ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò –ø–æ–∫–∞–∂—É–≤–∞ –∞–≥—Ä–µ—Å–∏—ò–∞, –Ω–µ–ø–æ—á–∏—Ç—É–≤–∞—ö–µ –∏–ª–∏ –æ—Ç—Ñ—Ä–ª–∞—ö–µ –Ω–∞ –Ω–æ—Ä–º–∏.",
        "–ë–∏–¥—É–≤–∞—ö–µ —ô—É–±–µ–∑–µ–Ω": "–ë–∏–¥—É–≤–∞—ö–µ —ô—É–±–µ–∑–µ–Ω ‚Äì —É–ø–æ—Ç—Ä–µ–±–∞ –Ω–∞ –∏–∑—Ä–∞–∑–∏ –Ω–∞ –ø–æ—á–∏—Ç, –∫—É–ª—Ç—É—Ä–Ω–∏ –∏ —É—á—Ç–∏–≤–∏ —Ñ–æ—Ä–º–∏.",
        "–ü—Ä–∏–∫–∞–∂—É–≤–∞—ö–µ –º–µ—ì—É—á–æ–≤–µ—á–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç": "–ü—Ä–∏–∫–∞–∂—É–≤–∞—ö–µ –º–µ—ì—É—á–æ–≤–µ—á–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç ‚Äì —ò–∞–∑–∏–∫ —à—Ç–æ –æ–¥—Ä–∞–∑—É–≤–∞ –Ω–µ—Å–æ–≥–ª–∞—Å—É–≤–∞—ö–µ, —Ä–∞—Å–ø—Ä–∞–≤–∏—ò–∞ –∏–ª–∏ —Ç–µ–Ω–∑–∏—ò–∞.",
        "–ú–æ—Ä–∞–ª–∏–∑–∏—Ä–∞—ö–µ": "–ú–æ—Ä–∞–ª–∏–∑–∏—Ä–∞—ö–µ ‚Äì –∏–∑—Ä–∞–∑—É–≤–∞—ö–µ –Ω–∞ —Å—É–¥–æ–≤–∏ –≤—Ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –º–æ—Ä–∞–ª–Ω–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≥–æ–≤–æ—Ä, –ø–∏—à—É–≤–∞—ö–µ –∏–ª–∏ —Ä–∞–∑–º–µ–Ω–∞ –Ω–∞ –ø–æ—Ä–∞–∫–∏.",
        "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∑–∞ –º–æ—ú": "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∑–∞ –º–æ—ú ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –ø–æ–∫–∞–∂—É–≤–∞–∞—Ç –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç, –¥–æ–º–∏–Ω–∞—Ü–∏—ò–∞ –∏–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∞.",
        "–ì–æ–≤–æ—Ä –∑–∞ –ø–æ—Å—Ç–∏–≥–Ω—É–≤–∞—ö–µ": "–ì–æ–≤–æ—Ä –∑–∞ –ø–æ—Å—Ç–∏–≥–Ω—É–≤–∞—ö–µ ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò –∏–∑—Ä–∞–∑—É–≤–∞ —Ü–µ–ª, –∞–º–±–∏—Ü–∏—ò–∞ –∏–ª–∏ —É—Å–ø–µ—Ö.",
        "–ò–Ω–¥–∏–∫–∞—Ü–∏—ò–∞ –Ω–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç": "–ò–Ω–¥–∏–∫–∞—Ü–∏—ò–∞ –Ω–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∞–ø—Å–æ–ª—É—Ç–Ω–∞ —É–≤–µ—Ä–µ–Ω–æ—Å—Ç.",
        "–ë–∏–¥—É–≤–∞—ö–µ –Ω–µ—Å–∏–≥—É—Ä–µ–Ω/–∫–æ–ª–µ–±–ª–∏–≤": "–ë–∏–¥—É–≤–∞—ö–µ –Ω–µ—Å–∏–≥—É—Ä–µ–Ω/–∫–æ–ª–µ–±–ª–∏–≤ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç —Å–æ–º–Ω–µ–∂, –Ω–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç –∏–ª–∏ —É—Å–ª–æ–≤–Ω–æ—Å—Ç.",
        "–£–≤–∏–¥": "–£–≤–∏–¥ ‚Äì —ò–∞–∑–∏–∫ —à—Ç–æ –ø–æ–∫–∞–∂—É–≤–∞ —Å–∞–º–æ—Å–≤–µ—Å—Ç, —Ä–∞–∑–±–∏—Ä–∞—ö–µ –∏–ª–∏ —Ä–∞–∑–º–∏—Å–ª—É–≤–∞—ö–µ.",
        "–°√® –∏–ª–∏ –Ω–∏—à—Ç–æ —Ä–∞–∑–º–∏—Å–ª—É–≤–∞—ö–µ": "–°√® –∏–ª–∏ –Ω–∏—à—Ç–æ —Ä–∞–∑–º–∏—Å–ª—É–≤–∞—ö–µ ‚Äì –∏–∑—Ä–∞–∑–∏ —Å–æ –∞–ø—Å–æ–ª—É—Ç–Ω–∏ —Ç–µ—Ä–º–∏–Ω–∏ –±–µ–∑ –Ω–∏—ò–∞–Ω—Å–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –º–µ–º–æ—Ä–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –º–µ–º–æ—Ä–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ —Å–µ—ú–∞–≤–∞—ö–µ –∏–ª–∏ –º–∏–Ω–∞—Ç–∏ –∏—Å–∫—É—Å—Ç–≤–∞.",
        "–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –µ–º–æ—Ü–∏—ò–∞": "–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –µ–º–æ—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –ø—Ä–µ–Ω–µ—Å—É–≤–∞–∞—Ç —Ä–∞–¥–æ—Å—Ç, —ô—É–±–æ–≤, –µ–Ω—Ç—É–∑–∏—ò–∞–∑–∞–º.",
        "–ù–µ–≥–∞—Ç–∏–≤–Ω–∞ –µ–º–æ—Ü–∏—ò–∞": "–ù–µ–≥–∞—Ç–∏–≤–Ω–∞ –µ–º–æ—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –ø—Ä–µ–Ω–µ—Å—É–≤–∞–∞—Ç —Ç–∞–≥–∞, –±–æ–ª–∫–∞ –∏–ª–∏ –æ–≥–æ—Ä—á–µ–Ω–æ—Å—Ç.",
        "–ê–Ω–∫—Å–∏–æ–∑–Ω–æ—Å—Ç": "–ê–Ω–∫—Å–∏–æ–∑–Ω–æ—Å—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∑–∞–≥—Ä–∏–∂–µ–Ω–æ—Å—Ç, —Å—Ç—Ä–∞–≤ –∏–ª–∏ –Ω–∞–ø–Ω–∞—Ç–æ—Å—Ç.",
        "–õ—É—Ç–∏–Ωa": "–õ—É—Ç–∏–Ωa ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –ø—Ä–µ–Ω–µ—Å—É–≤–∞–∞—Ç –≥–Ω–µ–≤, —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏—ò–∞ –∏–ª–∏ –∞–≥—Ä–µ—Å–∏—ò–∞.",
        "–¢–∞–≥–∞": "–¢–∞–≥–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–¥—Ä–∞–∑—É–≤–∞–∞—Ç –∂–∞–ª–æ—Å—Ç, –¥–µ–ø—Ä–µ—Å–∏—ò–∞ –∏–ª–∏ –º–µ–ª–∞–Ω—Ö–æ–ª–∏—ò–∞.",
        "–ü—Ü–æ–≤–∫–∏": "–ü—Ü–æ–≤–∫–∏ ‚Äì –≤—É–ª–≥–∞—Ä–Ω–∏ –∏–ª–∏ –Ω–µ–ø—Ä–∏—Å—Ç–æ—ò–Ω–∏ –∑–±–æ—Ä–æ–≤–∏.",
        "–ü–æ–∑–∏—Ç–∏–≤–µ–Ω —Ç–æ–Ω": "–ü–æ–∑–∏—Ç–∏–≤–µ–Ω —Ç–æ–Ω ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò —Å–æ–∑–¥–∞–≤–∞ –ø—Ä–∏—ò–∞—Ç–Ω–∞ –∏ –æ—Ö—Ä–∞–±—Ä—É–≤–∞—á–∫–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞.",
        "–ù–µ–≥–∞—Ç–∏–≤–µ–Ω —Ç–æ–Ω": "–ù–µ–≥–∞—Ç–∏–≤–µ–Ω —Ç–æ–Ω ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò —Å–æ–∑–¥–∞–≤–∞ –Ω–µ–ø—Ä–∏—ò–∞—Ç–Ω–∞ –∏–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞.",
        "–ù–µ—É—Ç—Ä–∞–ª–µ–Ω —Ç–æ–Ω": "–ù–µ—É—Ç—Ä–∞–ª–µ–Ω —Ç–æ–Ω ‚Äì —ò–∞–∑–∏–∫ –∫–æ—ò –µ —Ä–∞–º–Ω–æ–º–µ—Ä–µ–Ω –∏ –±–µ–∑ —Å–∏–ª–Ω–∞ –µ–º–æ—Ü–∏—ò–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –∞—É–¥–∏—Ç–∏–≤–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –∞—É–¥–∏—Ç–∏–≤–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–ø–∏—à—É–≤–∞–∞—Ç —Å–ª—É—à–∞—ö–µ –∏ –∑–≤—É—Ü–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤–∏–∑—É–µ–ª–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤–∏–∑—É–µ–ª–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–ø–∏—à—É–≤–∞–∞—Ç –≥–ª–µ–¥–∞—ö–µ –∏ —Å–ª–∏–∫–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø—Ä–æ—Å—Ç–æ—Ä–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø—Ä–æ—Å—Ç–æ—Ä–Ω–∞ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –ø–æ–∑–∏—Ü–∏—ò–∞, –Ω–∞—Å–æ–∫–∞ –∏ –ø—Ä–æ—Å—Ç–æ—Ä.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞ –Ω–∞ –¥–≤–∏–∂–µ—ö–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–µ—Ä—Ü–µ–ø—Ü–∏—ò–∞ –Ω–∞ –¥–≤–∏–∂–µ—ö–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–ø–∏—à—É–≤–∞–∞—Ç –ø—Ä–æ–º–µ–Ω–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏—ò–∞ –∏ –¥–∏–Ω–∞–º–∏–∫–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤–Ω–∏–º–∞–Ω–∏–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–ø–∏—à—É–≤–∞–∞—Ç —Ñ–æ–∫—É—Å, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—ò–∞ –∏–ª–∏ –∑–∞–±–µ–ª–µ–∂—É–≤–∞—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø—Ä–∏–≤–ª–µ—á–Ω–æ—Å—Ç": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø—Ä–∏–≤–ª–µ—á–Ω–æ—Å—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç —É–±–∞–≤–∏–Ω–∞, —à–∞—Ä–º –∏–ª–∏ –ø—Ä–∏–≤–ª–µ—á–Ω–æ—Å—Ç.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —ô—É–±–æ–ø–∏—Ç–Ω–æ—Å—Ç": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —ô—É–±–æ–ø–∏—Ç–Ω–æ—Å—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∏ –∂–µ–ª–±–∞ –∑–∞ –∑–Ω–∞–µ—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–∏–∑–∏–∫": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–∏–∑–∏–∫ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å–Ω–æ—Å—Ç.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –Ω–∞–≥—Ä–∞–¥–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –Ω–∞–≥—Ä–∞–¥–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –¥–æ–±–∏–≤–∫–∞, —É—Å–ø–µ—Ö –∏–ª–∏ –ø—Ä–∏–¥–æ–±–∏–≤–∫–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –ø–æ—Ç—Ä–µ–±–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –ø–æ—Ç—Ä–µ–±–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–ø–∏—à—É–≤–∞–∞—Ç –Ω–µ–æ–ø—Ö–æ–¥–Ω–∏ —É—Å–ª–æ–≤–∏ –∑–∞ –ø—Ä–µ–∂–∏–≤—É–≤–∞—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∂–µ–ª–±–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∂–µ–ª–±–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ –ª–∏—á–Ω–∏ —Å—Ç—Ä–µ–º–µ–∂–∏ –∏–ª–∏ –∫–æ–ø–Ω–µ–∂–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç —Å—Ç–µ–∫–Ω—É–≤–∞—ö–µ": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç —Å—Ç–µ–∫–Ω—É–≤–∞—ö–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –¥–æ–±–∏–≤–∞—ö–µ –∏–ª–∏ –ø–æ—Å–µ–¥—É–≤–∞—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –≥—É–±–µ—ö–µ –∏–ª–∏ –æ—Ç—Å—É—Å—Ç–≤–æ.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∏—Å–ø–æ–ª–Ω—É–≤–∞—ö–µ": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∏—Å–ø–æ–ª–Ω—É–≤–∞—ö–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –ø–æ—Å—Ç–∏–≥–Ω—É–≤–∞—ö–µ –∏–ª–∏ –∑–∞–¥–æ–≤–æ–ª—É–≤–∞—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∑–∞–º–æ—Ä": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∑–∞–º–æ—Ä ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ —É–º–æ—Ä –∏–ª–∏ –∏—Å—Ü—Ä–ø–µ–Ω–æ—Å—Ç.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –±–æ–ª–µ—Å—Ç": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –±–æ–ª–µ—Å—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Ñ–∏–∑–∏—á–∫–∞ –∏–ª–∏ –ø—Å–∏—Ö–∏—á–∫–∞ –±–æ–ª–µ—Å—Ç.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∑–¥—Ä–∞–≤—ò–µ": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∑–¥—Ä–∞–≤—ò–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –±–ª–∞–≥–æ—Å–æ—Å—Ç–æ—ò–±–∞ –∏ –≤–∏—Ç–∞–ª–Ω–æ—Å—Ç.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –º–µ–Ω—Ç–∞–ª–Ω–æ –∑–¥—Ä–∞–≤—ò–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –º–µ–Ω—Ç–∞–ª–Ω–æ –∑–¥—Ä–∞–≤—ò–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ –ø—Å–∏—Ö–æ–ª–æ—à–∫–∞ —Å–æ—Å—Ç–æ—ò–±–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ö—Ä–∞–Ω–∞ –∏–ª–∏ —ò–∞–¥–µ—ö–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ö—Ä–∞–Ω–∞ –∏–ª–∏ —ò–∞–¥–µ—ö–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –∏—Å—Ö—Ä–∞–Ω–∞ –∏–ª–∏ –∞–∫—Ç–∏ –Ω–∞ —ò–∞–¥–µ—ö–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–º—Ä—Ç": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–º—Ä—Ç ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç —É–º–∏—Ä–∞—ö–µ, –∫—Ä–∞—ò –∏–ª–∏ –∑–∞–≥—É–±–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–∞–º–æ–ø–æ–≤—Ä–µ–¥—É–≤–∞—ö–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–∞–º–æ–ø–æ–≤—Ä–µ–¥—É–≤–∞—ö–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –Ω–∞–Ω–µ—Å—É–≤–∞—ö–µ —à—Ç–µ—Ç–∞ –Ω–∞ —Å–µ–±–µ—Å–∏.",
        "–°–µ–∫—Å—É–∞–ª–Ω–∞ —Å–æ–¥—Ä–∂–∏–Ω–∞": "–°–µ–∫—Å—É–∞–ª–Ω–∞ —Å–æ–¥—Ä–∂–∏–Ω–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ —Å–µ–∫—Å –∏–ª–∏ –µ—Ä–æ—Ç–∏–∫–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–ª–æ–±–æ–¥–Ω–æ –≤—Ä–µ–º–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Å–ª–æ–±–æ–¥–Ω–æ –≤—Ä–µ–º–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç —Ä–µ–∫—Ä–µ–∞—Ü–∏—ò–∞ –∏ —Ö–æ–±–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –¥–æ–º": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –¥–æ–º ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –∂–∏–≤–µ–∞–ª–∏—à—Ç–µ –∏ —Å–µ–º–µ—ò—Å—Ç–≤–æ.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–∞–±–æ—Ç–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–∞–±–æ—Ç–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–æ—Ñ–µ—Å–∏—ò–∞ –∏ –∑–∞–¥–∞—á–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–∞—Ä–∏": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–∞—Ä–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç —Ñ–∏–Ω–∞–Ω—Å–∏–∏ –∏ –µ–∫–æ–Ω–æ–º–∏—ò–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–µ–ª–∏–≥–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ —Ä–µ–ª–∏–≥–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –¥—É—Ö–æ–≤–Ω–æ—Å—Ç –∏ –≤–µ—Ä—Å–∫–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–æ–ª–∏—Ç–∏–∫–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –ø–æ–ª–∏—Ç–∏–∫–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –≤–ª–∞—Å—Ç –∏ –æ–ø—à—Ç–µ—Å—Ç–≤–µ–Ω–∏ –æ–¥–Ω–æ—Å–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –∫—É–ª—Ç—É—Ä–∞": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –∫—É–ª—Ç—É—Ä–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ —É–º–µ—Ç–Ω–æ—Å—Ç, —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç.",
        "–ü—Ü–æ–≤–∫–∏": "–ü—Ü–æ–≤–∫–∏ ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—É–ª–≥–∞—Ä–Ω–∏ –∏–ª–∏ –Ω–µ–ø—Ä–∏—Å—Ç–æ—ò–Ω–∏ –∑–±–æ—Ä–æ–≤–∏.",
        "–°—Ç—Ä–∞–Ω—Å–∫–∏ –∑–±–æ—Ä–æ–≤–∏": "–°—Ç—Ä–∞–Ω—Å–∫–∏ –∑–±–æ—Ä–æ–≤–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –Ω–µ –ø—Ä–∏–ø–∞—ì–∞–∞—Ç –Ω–∞ –º–∞–∫–µ–¥–æ–Ω—Å–∫–∏–æ—Ç —ò–∞–∑–∏–∫.",
        "–ù–∞—É—á–Ω–∏ –∑–±–æ—Ä–æ–≤–∏": "–ù–∞—É—á–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ ‚Äì —Ç–µ—Ä–º–∏–Ω–∏ –∫–æ–∏ —Å–µ –∫–æ—Ä–∏—Å—Ç–∞—Ç –≤–æ –∞–∫–∞–¥–µ–º—Å–∫–∏ –∏–ª–∏ —Å—Ç—Ä—É—á–Ω–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∏.",
        "–°–ª–µ–Ω–≥ –∑–±–æ—Ä–æ–≤–∏": "–°–ª–µ–Ω–≥ –∑–±–æ—Ä–æ–≤–∏ ‚Äì –Ω–µ—Ñ–æ—Ä–º–∞–ª–Ω–∏ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∏ –∏–∑—Ä–∞–∑–∏.",
        "–°–ª–µ–Ω–≥ –æ–¥ —Å–æ—Ü–∏—ò–∞–ª–Ω–∏ –º—Ä–µ–∂–∏": "–°–ª–µ–Ω–≥ –æ–¥ —Å–æ—Ü–∏—ò–∞–ª–Ω–∏ –º—Ä–µ–∂–∏ ‚Äì —Å–æ–≤—Ä–µ–º–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–ª–µ–Ω–≥ –∏ –∫—Ä–∞—Ç–µ–Ω–∫–∏.",
        "–ó–±–æ—Ä–æ–≤–∏-–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (filler words)": "–ó–±–æ—Ä–æ–≤–∏-–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ (filler words) ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –Ω–µ –¥–æ–¥–∞–≤–∞–∞—Ç –∑–Ω–∞—á–µ—ö–µ, –Ω–æ —ò–∞ –ø–æ–ø–æ–ª–Ω—É–≤–∞–∞—Ç —Ä–µ—á–µ–Ω–∏—Ü–∞—Ç–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ –º–∏–Ω–∞—Ç–æ—Ç–æ": "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ –º–∏–Ω–∞—Ç–æ—Ç–æ ‚Äì –∏–∑—Ä–∞–∑–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏ –Ω–∞—Å—Ç–∞–Ω–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ —Å–µ–≥–∞—à–Ω–æ—Å—Ç–∞": "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ —Å–µ–≥–∞—à–Ω–æ—Å—Ç–∞ ‚Äì –∏–∑—Ä–∞–∑–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –º–æ–º–µ–Ω—Ç–∞–ª–Ω–æ—Ç–æ –≤—Ä–µ–º–µ.",
        "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ –∏–¥–Ω–∏–Ω–∞—Ç–∞": "–ó–±–æ—Ä–æ–≤–∏ —Ñ–æ–∫—É—Å–∏—Ä–∞–Ω–∏ –Ω–∞ –∏–¥–Ω–∏–Ω–∞—Ç–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–µ—Ç—Å—Ç–æ—ò–Ω–∏ –Ω–∞—Å—Ç–∞–Ω–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤—Ä–µ–º–µ": "–ó–±–æ—Ä–æ–≤–∏ –ø–æ–≤—Ä–∑–∞–Ω–∏ —Å–æ –≤—Ä–µ–º–µ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–ø–∏—à—É–≤–∞–∞—Ç –ø–µ—Ä–∏–æ–¥–∏ –∏ —Ç—Ä–∞–µ—ö–µ.",
        "–ü–æ–≥—Ä–µ—à–Ω–æ –Ω–∞–ø–∏—à–∞–Ω–∏ –∑–±–æ—Ä–æ–≤–∏": "–ü–æ–≥—Ä–µ—à–Ω–æ –Ω–∞–ø–∏—à–∞–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —Å–æ –ø—Ä–∞–≤–æ–ø–∏—Å–Ω–∏ –≥—Ä–µ—à–∫–∏.",
        "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏": "–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∫–æ–∏ —Å–µ –ø–æ—ò–∞–≤—É–≤–∞–∞—Ç –ø–æ–≤–µ—ú–µ–ø–∞—Ç–∏ –±–µ–∑ –ø—Ä–∏—á–∏–Ω–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∫–æ–ª–∏—á–∏–Ω–∞": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –∏–∑—Ä–∞–∑—É–≤–∞–∞—Ç –∫–æ–ª–∏—á–∏–Ω–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –±—Ä–æ—ò –∏–ª–∏ –º–µ—Ä–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–µ–º–µ—ò—Å—Ç–≤–æ": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–µ–º–µ—ò—Å—Ç–≤–æ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–º–µ–Ω—É–≤–∞–∞—Ç —á–ª–µ–Ω–æ–≤–∏ –Ω–∞ —Å–µ–º–µ—ò—Å—Ç–≤–æ.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –ø—Ä–∏—ò–∞—Ç–µ–ª–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –ø—Ä–∏—ò–∞—Ç–µ–ª–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –ø—Ä–∏—ò–∞—Ç–µ–ª—Å–∫–∏ –æ–¥–Ω–æ—Å–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –º–∞–∂–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –º–∞–∂–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –º–∞—à–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –∂–µ–Ω–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –∂–µ–Ω–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–µ –æ–¥–Ω–µ—Å—É–≤–∞–∞—Ç –Ω–∞ –∂–µ–Ω—Å–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –º–∏–ª–µ–Ω–∏—Ü–∏": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –º–∏–ª–µ–Ω–∏—Ü–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –∏–º–µ–Ω—É–≤–∞–∞—Ç –¥–æ–º–∞—à–Ω–∏ –∂–∏–≤–æ—Ç–Ω–∏.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–æ—Ü–∏—ò–∞–ª–µ–Ω —Å—Ç–∞—Ç—É—Å": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–æ—Ü–∏—ò–∞–ª–µ–Ω —Å—Ç–∞—Ç—É—Å ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ –ø–æ–∫–∞–∂—É–≤–∞–∞—Ç –æ–ø—à—Ç–µ—Å—Ç–≤–µ–Ω–∞ –ø–æ–ª–æ–∂–±–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–∏—Ä–æ–º–∞—à—Ç–∏—ò–∞": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç —Å–∏—Ä–æ–º–∞—à—Ç–∏—ò–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ –Ω–µ–¥–æ—Å—Ç–∏–≥ –Ω–∞ —Å—Ä–µ–¥—Å—Ç–≤–∞.",
        "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –±–æ–≥–∞—Ç—Å—Ç–≤–æ": "–ó–±–æ—Ä–æ–≤–∏ –∫–æ–∏ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –±–æ–≥–∞—Ç—Å—Ç–≤–æ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —É–∫–∞–∂—É–≤–∞–∞—Ç –Ω–∞ –∏–∑–æ–±–∏–ª—Å—Ç–≤–æ –∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–∏—Å–∫–∞ –º–æ—ú.",
        "–ò–Ω—Ç–µ—Ä–ø—É–Ω–∫—Ü–∏—Å–∫–∏ —Å–∏–º–±–æ–ª–∏": "–ò–Ω—Ç–µ—Ä–ø—É–Ω–∫—Ü–∏—Å–∫–∏ —Å–∏–º–±–æ–ª–∏ ‚Äì —Å–∏—Ç–µ –∑–Ω–∞—Ü–∏ –Ω–∞ –∏–Ω—Ç–µ—Ä–ø—É–Ω–∫—Ü–∏—ò–∞ (.,!?).",
        "–°–æ—Å—Ç–∞–≤–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ —Å–æ —Ü—Ä—Ç–∏—á–∫–∞": "–°–æ—Å—Ç–∞–≤–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ —Å–æ —Ü—Ä—Ç–∏—á–∫–∞ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —à—Ç–æ —Å–æ–¥—Ä–∂–∞—Ç —Ç–∏—Ä–µ (–Ω–∞ –ø—Ä. —Ü—Ä–≤–µ–Ω–æ-–±–µ–ª).",
        "–û–∫—Å—Ñ–æ—Ä–¥—Å–∫–∞ –∑–∞–ø–∏—Ä–∫–∞": "–û–∫—Å—Ñ–æ—Ä–¥—Å–∫–∞ –∑–∞–ø–∏—Ä–∫–∞ ‚Äì –∑–∞–ø–∏—Ä–∫–∞ –ø—Ä–µ–¥ '–∏' –≤–æ —Å–ø–∏—Å–æ–∫.",
        "–ó–±–æ—Ä–æ–≤–∏ –≤–æ –∑–∞–≥—Ä–∞–¥–∏": "–ó–±–æ—Ä–æ–≤–∏ –≤–æ –∑–∞–≥—Ä–∞–¥–∏ ‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç –≤–º–µ—Ç–Ω–∞—Ç –º–µ—ì—É –∑–∞–≥—Ä–∞–¥–∏.",
        "–ë—Ä–æ–µ–≤–∏": "–ë—Ä–æ–µ–≤–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ –∏–ª–∏ —Å–∏–º–±–æ–ª–∏ —à—Ç–æ –æ–∑–Ω–∞—á—É–≤–∞–∞—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞.",
        "–ò–∑–¥–æ–ª–∂–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏": "–ò–∑–¥–æ–ª–∂–µ–Ω–∏ –∑–±–æ—Ä–æ–≤–∏ ‚Äì –∑–±–æ—Ä–æ–≤–∏ —Å–æ –Ω–∞–º–µ—Ä–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏ –±—É–∫–≤–∏ (–Ω–∞ –ø—Ä. ‚Äû–¥–æ–ª–≥–æ–æ–æ–æ‚Äú)."
    }

        self.system={"role": "system","content": 
            ("[INST]–†–∞–∑–≥–æ–≤–æ—Ä –ø–æ–º–µ—ì—É –∫–æ—Ä–∏—Å–Ω–∏–∫ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫ –∑–∞ –µ–∫—Å—Ç—Ä–∞–∫—Ü–∏—ò–∞ –Ω–∞ —Å—Ç–∏–ª –º–∞–∫–µ–¥–æ–Ω—Å–∫–∞ –ø–æ–µ–∑–∏—ò–∞. –ê—Å–∏—Å—Ç–µ–Ω—Ç–æ—Ç –¥–∞–≤–∞ –∫–æ—Ä–∏—Å–Ω–∏, –¥–µ—Ç–∞–ª–Ω–∏ –∏ —ô—É–±–µ–∑–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ –ø—Ä–∞—à–∞—ö–∞—Ç–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç.–ê–∫–æ –µ –ø—Ä–∏—Å—É—Ç–Ω–∞ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ç–∞, –æ–¥–æ–≥–æ—Ä–∏ —Å–æ –î–ê –Ω–∞ –ø–æ—á–µ—Ç–æ–∫–æ—Ç, –ø—Ä–æ—Å–ª–µ–¥–µ–Ω–æ —Å–æ –æ–±—Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ. –ê–∫–æ –Ω–µ –µ –ø—Ä–∏—Å—É—Ç–Ω–∞, –æ–¥–≥–æ–≤–æ—Ä–∏ —Å–∞–º–æ —Å–æ –ù–ï –∏ –Ω–∏—à—Ç–æ –¥—Ä—É–≥–æ.–û—Ü–µ–Ω–∏ –≥–æ –ø—Ä–∏—Å—É—Å—Ç–≤–æ—Ç–æ –æ–¥ 0 –¥–æ 1 –Ω–∞ —Å—Ç–∏–ª–æ—Ç.[/INST]</s>.")}
        
        self.db=PoetryDB()
        self.CSV_PATH="classification/cleaned_songs.csv"
        self.df=pd.read_csv(self.CSV_PATH)
        self.random_seed=47
        self.styles_path='extracted_styles.csv'
        self.bedrock = boto3.client("bedrock-runtime", region_name="eu-central-1")
        
        
    def extract_n_random_songs_for_author(self, author_name='–ë–ª–∞–∂–µ –ö–æ–Ω–µ—Å–∫–∏', number_of_songs=10):
        author_songs = self.df[self.df['author'] == author_name]
        return author_songs.sample(
            n=min(number_of_songs, len(author_songs)),
            random_state=None  
        )
    def extract_all_songs_for_author(self, author_name='–ë–ª–∞–∂–µ –ö–æ–Ω–µ—Å–∫–∏'):
        return self.df[self.df['author'] == author_name]
    
    def extract_styles_from_song(self,song):
        pass
    def extract_style_from_song(self,song,target_feature,target_feature_definition):
        
        user_message = (
            f"{target_feature_definition}\n"
            "–û–≤–∞ —ò–∞ –ø—Ä–µ—Ç—Å—Ç–∞–≤—É–≤–∞ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—ò–∞—Ç–∞, –Ω–µ —ò–∞ –¥–∞–≤–∞—ò –Ω–µ—ò–∑–µ, –≤–æ —Ç–≤–æ—ò–æ—Ç –æ–¥–≥–æ–≤–æ—Ä.\n\n"
            f"–ù–∞–ø–∏—à–∏ –∫—Ä–∞—Ç–æ–∫ –æ–ø–∏—Å –¥–∞–ª–∏ –∞–≤—Ç–æ—Ä–æ—Ç –Ω–∞ —Å–ª–µ–¥–Ω–∏–æ—Ç –ø–∞—Å—É—Å —ò–∞ —Å–æ–¥—Ä–∂–∏ –æ–≤–∞–∞ –æ—Å–æ–±–∏–Ω–∞: {target_feature}.\n"
            "–û–¥–≥–æ–≤–æ—Ä–∏ —Å–æ –î–∞ –∏–ª–∏ –ù–µ.\n\n"
            "–°–ª–µ–¥—É–≤–∞–∞—Ç –Ω–µ–∫–æ–ª–∫—É –ø—Ä–∏–º–µ—Ä–∏:\n\n"

            "–ü—Ä–∏–º–µ—Ä 1:\n"
            "–û—Å–æ–±–∏–Ω–∞: –°–∞—Ä–∫–∞–∑–∞–º\n"
            "–ü–∞—Å—É—Å: ‚Äû–û, –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ! –ë–∞—à —Å–∞–∫–∞–≤ –¥–∞ –º–∏ —Å–µ —Ä–∞—Å–∏–ø–µ —Ç–µ–ª–µ—Ñ–æ–Ω–æ—Ç —Å—Ä–µ–¥ –±–µ–ª –¥–µ–Ω.‚Äú\n"
            "–û–ø–∏—Å: –ê–≤—Ç–æ—Ä–æ—Ç –∑–±–æ—Ä—É–≤–∞ –∏—Ä–æ–Ω–∏—á–Ω–æ, –∏–∑—Ä–∞–∑—É–≤–∞—ò—ú–∏ —Å–ø—Ä–æ—Ç–∏–≤–Ω–æ –æ–¥ —Ç–æ–∞ —à—Ç–æ –º–∏—Å–ª–∏. –û–¥–≥–æ–≤–æ—Ä: –î–∞.\n\n"

            "–ü—Ä–∏–º–µ—Ä 2:\n"
            "–û—Å–æ–±–∏–Ω–∞: –°–∞—Ä–∫–∞–∑–∞–º\n"
            "–ü–∞—Å—É—Å: ‚Äû–ú–æ—ò–æ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω —Å–µ —Ä–∞—Å–∏–ø–∞ –¥–µ–Ω–µ—Å –∏ —Ç–æ–∞ –º–∏ –≥–æ —É–Ω–∏—à—Ç–∏ –¥–µ–Ω–æ—Ç.‚Äú\n"
            "–û–ø–∏—Å: –ê–≤—Ç–æ—Ä–æ—Ç –¥–∏—Ä–µ–∫—Ç–Ω–æ –≥–æ –∏–∑—Ä–∞–∑—É–≤–∞ —Å–≤–æ–µ—Ç–æ –Ω–µ–∑–∞–¥–æ–≤–æ–ª—Å—Ç–≤–æ –±–µ–∑ –∏—Ä–æ–Ω–∏—ò–∞ –∏–ª–∏ –ø–æ—Ç—Å–º–µ–≤. –û–¥–≥–æ–≤–æ—Ä: –ù–µ.\n\n"

            
            "–ü—Ä–∏–º–µ—Ä 3:\n"
            "–û—Å–æ–±–∏–Ω–∞: –ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å\n"
            "–ü–∞—Å—É—Å: ‚Äû–à–∞—Å —ò–∞ –Ω–∞–ø–∏—à–∞–≤ –ø–µ—Å–Ω–∞—Ç–∞ –∑–∞ –µ–¥–µ–Ω —á–∞—Å.‚Äú\n"
            "–û–ø–∏—Å: –ê–≤—Ç–æ—Ä–æ—Ç –∫–æ—Ä–∏—Å—Ç–∏ –∞–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å –∫–∞–¥–µ —à—Ç–æ –ø–æ–¥–º–µ—Ç–æ—Ç —ò–∞ –∏–∑–≤—Ä—à—É–≤–∞ –¥–µ—ò—Å—Ç–≤–æ—Ç–æ. –û–¥–≥–æ–≤–æ—Ä: –î–∞.\n\n"

            f"–ü–∞—Å—É—Å:\n{song}\n\n–û–ø–∏—Å:"
        )
        messages = [self.system,{"role": "user", "content": user_message}]

        payload = {
        "model": "trajkovnikola/MKLLM-7B-Instruct",
        "messages": messages,
        "temperature": 0.3,
        "repetition_penalty":2,
        "frequency_penalty": 0.4,
        "presence_penalty": 0.3,
        "top_p": 0.9,
        "max_tokens":200,
        "stop": ["\n","\n\n","<|im_end|>"]}
        
        resp = requests.post("http://127.0.0.1:8080/v1/chat/completions",
        headers={"Content-Type": "application/json"},
        json=payload)
        
        data = resp.json()
        return data["choices"][0]["message"]["content"].strip()
        
    def extract_style_from_songs(self, sample_songs=[], output_dir=''):
        if output_dir and not os.path.exists(output_dir):
            os.makedirs(output_dir)

        output_path = os.path.join(output_dir, "extracted_styles.csv") if output_dir else "extracted_styles.csv"

        total_time=0
        file_exists = os.path.exists(output_path)

        for _, row in sample_songs.iterrows():
            author = row["author"]
            song = row["song_title"]
            original_song = row["song_text"]

            for category, definition in self.styles_map.items():
                start_time = time.time()

                extracted_text=self.extract_style_from_song(song,category,definition)
                
                end_time = time.time()
                time_needed = end_time - start_time

                
                df_row = pd.DataFrame([{
                    "author": author,
                    "song": song,
                    "style_feature_category": category,
                    "extracted_text": extracted_text,
                    #"original_song": original_song,
                    "time_needed": time_needed
                }])
                total_time+=time_needed
                
                df_row.to_csv(output_path, mode="a", index=False, header=not file_exists)
                file_exists = True

                
                print(f"[SAVED] Author='{author}', Song='{song}', Style='{category}', Time={time_needed:.2f}s")
            
            print(f'Total time {total_time:.2f}')
    def iterate_over_author(self,author):
        songs=self.extract_n_random_songs_for_author(author_name=author,number_of_songs=1)
        self.extract_style_from_songs(songs)

    def get_present_styles_for_song(self, title, author):
        self.df = pd.read_csv(self.styles_path)
        pattern = r'^–î–∞' 
        return self.df[
            (self.df['author']== author) & (self.df['song']==title) &
            (self.df['extracted_text'].str.match(pattern, na=False))
        ]
    def apply_styles_iterative(self, styles, st_song_text, st_song_title, st_author, log_path=None):
    
        song = st_song_text

        
        if log_path is None:
            ts = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
            log_path = f"song_style_log_{st_song_title or 'song'}_{ts}.txt"
            log_path = "".join(c for c in log_path if c.isalnum() or c in (' ','.','_','-')).rstrip()

        log_dir = os.path.dirname(log_path)
        if log_dir:
            os.makedirs(log_dir, exist_ok=True)

        cumulative = 0.0
        total_styles = len(styles)

        with open(log_path, "a", encoding="utf-8") as log_file:
            for i, (_, row) in enumerate(styles.iterrows()):
                target_feature = row['style_feature_category']
                target_feature_definition = self.styles_map.get(target_feature, "")
                
                example_1="–û—Å–æ–±–∏–Ω–∞:–°–∞—Ä–∫–∞–∑–∞–º\n–û—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ: –î–µ–Ω–µ—Å —Ä–∞–±–æ—Ç–µ–≤ —Ü–µ–ª –¥–µ–Ω –±–µ–∑ –ø–∞—É–∑–∞.\n–°–æ ‚Äû–°–∞—Ä–∫–∞–∑–∞–º‚Äú: –û, –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ, —Ç–æ–∫–º—É —Ç–æ–∞ –º–∏ —Ç—Ä–µ–±–∞—à–µ ‚Äî —É—à—Ç–µ –µ–¥–µ–Ω –¥–µ–Ω –±–µ–∑ –æ–¥–º–æ—Ä!\n"
                example_2="–û—Å–æ–±–∏–Ω–∞:–ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å\n–û—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ: –ü–∏—Å–º–æ—Ç–æ –±–µ—à–µ –∏—Å–ø—Ä–∞—Ç–µ–Ω–æ –æ–¥ –º–µ–Ω–µ.\n–°–æ ‚Äû–ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å‚Äú: –à–∞—Å –≥–æ –∏—Å–ø—Ä–∞—Ç–∏–≤ –ø–∏—Å–º–æ—Ç–æ\n"
                
                user_message = (
                    f"{target_feature_definition}\n –û–≤–∞ —ò–∞ –ø—Ä–µ—Ç—Å—Ç–∞–≤—É–≤–∞ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—ò–∞—Ç–∞, –Ω–µ —ò–∞ –¥–∞–≤–∞—ò –Ω–µ—ò–∑–µ, –≤–æ —Ç–≤–æ—ò–æ—Ç –æ–¥–≥–æ–≤–æ—Ä\n\n"
                    f"–ò—Å–∫–æ—Ä–∏—Å—Ç–∏ —ò–∞ –æ–≤–∞–∞ –æ—Å–æ–±–∏–Ω–∞ {target_feature} –í–†–ó –ø–µ—Å–Ω–∞—Ç–∞: .\n"
                    f"–ö–∞–∫–æ –æ–¥–≥–æ–≤–æ—Ä –≤—Ä–∞—Ç–∏ —ò–∞ –Ω–∞–∑–∞–¥ –ø–µ—Å–Ω–∞—Ç–∞, –Ω–æ —Å–æ –ø—Ä–∏–º–µ–Ω–µ—Ç {target_feature} –≤—Ä–∑ –Ω–µ—ò–∑–µ. –û–≤–∞–∞ –µ –∫–ª—É—á–Ω–æ.\n"
                    f"–°–ª–µ–¥—É–≤–≤–∞—Ç –¥–≤–∞ –ø—Ä–∏–º–µ—Ä–∏:\n"
                    f'{example_1}'
                    f'{example_2}'
                    f"–ü–∞—Å—É—Å:\n{song}\n\n –û–±—Ä–∞–±–æ—Ç–µ–Ω–∞ –ø–µ—Å–Ω–∞:"
                )
                
               
                new_system={"role": "system","content": 
                ("[INST]–†–∞–∑–≥–æ–≤–æ—Ä –ø–æ–º–µ—ì—É –∫–æ—Ä–∏—Å–Ω–∏–∫ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫  –∑–∞ –ø—Ä–∏–º–µ–Ω—É–≤–∞—ö–µ –Ω–∞  —Å—Ç–∏–ª –º–∞–∫–µ–¥–æ–Ω—Å–∫–∞ –ø–æ–µ–∑–∏—ò–∞. –ê—Å–∏—Å—Ç–µ–Ω—Ç–æ—Ç –¥–∞–≤–∞ –∫–æ—Ä–∏—Å–Ω–∏, –¥–µ—Ç–∞–ª–Ω–∏ –∏ —ô—É–±–µ–∑–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ –ø—Ä–∞—à–∞—ö–∞—Ç–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç.[/INST]</s>.")}
                #probaj so indivdualni primeri pomali 
                #predefinirani stilovi na ekstrakjcija i da proveri dali e prisuten
                # (/) vsushnost razlika na stilovi
                #ostavi default
                #podobro odednash site i da se zpaishi akko zakluchok
                messages = [new_system, {"role": "user", "content": user_message}]

                payload = {
                    "model": "trajkovnikola/MKLLM-7B-Instruct",
                    "messages": messages,
                    "temperature": 0.2,
                    "top_p": 0.9,
                    "repetition_penalty": 2,
                    'early_stopping':True,
                    "frequency_penalty": 0.2,
                    "presence_penalty": 0.15,
                    'stop': ["<|im_end|>"],
                    "max_tokens":len(song),
                }
                """"output_ids = self.model.generate(input_ids=data_x_input_ids,
                                                 attention_mask=data_x_attention_mask,
                                                 max_new_tokens=max_length,
                                                 eos_token_id=tokenizer.eos_token_id,
                                                 pad_token_id=tokenizer.pad_token_id,
                                                 early_stopping=True,
                                                 num_return_sequences=1,
                                                 # no_repeat_ngram_size=2,
                                                 # repetition_penalty=2.0,
                                                 do_sample=False,
                                                 # top_p=0.5
                                                 )"""
                
                start_time = time.time()
                try:
                    resp = requests.post(
                        "http://127.0.0.1:8080/v1/chat/completions",
                        headers={"Content-Type": "application/json"},
                        json=payload,
                        timeout=200
                    )
                    duration = time.time() - start_time

                    if resp.ok:
                        data = resp.json()
                        new_song = data.get("choices", [{}])[0].get("message", {}).get("content", "").strip()

                        if not new_song:
                            new_song = song
                            note = f" (empty response ‚Äî kept previous song text)"
                        else:
                            note = ""
                    else:
                        new_song = song
                        note = f" (request failed: status {resp.status_code})"

                except Exception as e:
                    duration = time.time() - start_time
                    new_song = song
                    note = f" (exception during request: {e})"

                cumulative += duration
                song = new_song

                
                print("\n" + "="*40)
                print(f"Iteration {i+1}/{total_styles} - style added: {target_feature}")
                print(f"Duration: {duration:.3f} s{note}")
                print("-" * 40)
                print(song)
                print("="*40 + "\n")

                log_file.write(f"--- Iteration {i+1} / {total_styles} ---\n")
                log_file.write(f"Style added: {target_feature}\n")
                log_file.write(f"Author: {st_author}\n")
                log_file.write(f"Song title: {st_song_title}\n")
                log_file.write(f"Duration (s): {duration:.3f}\n")
                log_file.write(f"Cumulative duration (s): {cumulative:.3f}\n")
                if note:
                    log_file.write(f"Note: {note}\n")
                log_file.write("Resulting song:\n")
                log_file.write(song + "\n\n")
                log_file.flush()

        return song, log_path
    def apply_styles_all_at_once(self,styles,st_song_text):
           
            song=st_song_text
            max_words=len(st_song_text)
           
            target_features = []
            target_feature_definitions = []

            for _, row in styles.iterrows():
                target_feature = row['style_feature_category']
                target_features.append(target_feature)
                target_feature_definitions.append(self.styles_map[target_feature])

            # Join definitions in a readable numbered format
            definitions_text = "–î–µ—Ñ–∏–Ω–∏—Ü–∏–∏ –Ω–∞ –æ—Å–æ–±–∏–Ω–∏:\n" + "\n".join(
                [f"{i+1}. {target_features[i]} ‚Äì {target_feature_definitions[i]}" for i in range(len(target_features))]
            )

            example_1 = (
                "–û—Å–æ–±–∏–Ω–∞: –°–∞—Ä–∫–∞–∑–∞–º\n"
                "–û—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ: –î–µ–Ω–µ—Å —Ä–∞–±–æ—Ç–µ–≤ —Ü–µ–ª –¥–µ–Ω –±–µ–∑ –ø–∞—É–∑–∞.\n"
                "–°–æ ‚Äû–°–∞—Ä–∫–∞–∑–∞–º‚Äú: –û, –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ, —Ç–æ–∫–º—É —Ç–æ–∞ –º–∏ —Ç—Ä–µ–±–∞—à–µ ‚Äî —É—à—Ç–µ –µ–¥–µ–Ω –¥–µ–Ω –±–µ–∑ –æ–¥–º–æ—Ä!\n"
            )
            example_2 = (
                "–û—Å–æ–±–∏–Ω–∞: –ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å\n"
                "–û—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ: –ü–∏—Å–º–æ—Ç–æ –±–µ—à–µ –∏—Å–ø—Ä–∞—Ç–µ–Ω–æ –æ–¥ –º–µ–Ω–µ.\n"
                "–°–æ ‚Äû–ê–∫—Ç–∏–≤–µ–Ω –≥–ª–∞—Å‚Äú: –à–∞—Å –≥–æ –∏—Å–ø—Ä–∞—Ç–∏–≤ –ø–∏—Å–º–æ—Ç–æ.\n"
            )

            user_message = (
                f"{definitions_text}\n"
                f"–û–≤–∞ —ò–∞ –ø—Ä–µ—Ç—Å—Ç–∞–≤—É–≤–∞ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—ò–∞—Ç–∞, –Ω–µ —ò–∞ –¥–∞–≤–∞—ò –Ω–µ—ò–∑–µ, –≤–æ —Ç–≤–æ—ò–æ—Ç –æ–¥–≥–æ–≤–æ—Ä.\n\n"
                f"–ò—Å–∫–æ—Ä–∏—Å—Ç–∏ —ò–∞ –æ–≤–∞–∞ –æ—Å–æ–±–∏–Ω–∞ {target_feature} –í–†–ó –ø–µ—Å–Ω–∞—Ç–∞.\n"
                f"–ö–∞–∫–æ –æ–¥–≥–æ–≤–æ—Ä –≤—Ä–∞—Ç–∏ —ò–∞ –Ω–∞–∑–∞–¥ –ø–µ—Å–Ω–∞—Ç–∞, –Ω–æ —Å–æ –ø—Ä–∏–º–µ–Ω–µ—Ç {target_feature} –≤—Ä–∑ –Ω–µ—ò–∑–µ. –û–≤–∞–∞ –µ –∫–ª—É—á–Ω–æ.\n"
                f"–°–ª–µ–¥—É–≤–∞–∞—Ç –¥–≤–∞ –ø—Ä–∏–º–µ—Ä–∏:\n"
                f"{example_1}"
                f"{example_2}"
                f"–ü–∞—Å—É—Å:\n{song}\n\n–û–±—Ä–∞–±–æ—Ç–µ–Ω–∞ –ø–µ—Å–Ω–∞:"
            )
               
            new_system={"role": "system","content": 
                ("[INST]–†–∞–∑–≥–æ–≤–æ—Ä –ø–æ–º–µ—ì—É –∫–æ—Ä–∏—Å–Ω–∏–∫ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫  –∑–∞ –ø—Ä–∏–º–µ–Ω—É–≤–∞—ö–µ –Ω–∞  —Å—Ç–∏–ª –º–∞–∫–µ–¥–æ–Ω—Å–∫–∞ –ø–æ–µ–∑–∏—ò–∞. –ê—Å–∏—Å—Ç–µ–Ω—Ç–æ—Ç –¥–∞–≤–∞ –∫–æ—Ä–∏—Å–Ω–∏, –¥–µ—Ç–∞–ª–Ω–∏ –∏ —ô—É–±–µ–∑–Ω–∏ –æ–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ –ø—Ä–∞—à–∞—ö–∞—Ç–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç.[/INST]</s>.")}
            
            messages = [new_system,{"role": "user", "content": user_message}]

            payload = {
                "model": "trajkovnikola/MKLLM-7B-Instruct",
                "messages": messages,
                "temperature": 0.2,
                "repetition_penalty": 2.0,
                "frequency_penalty": 0.2,
                "presence_penalty": 0.15,
                "top_p": 0.9,
                "max_tokens":max_words,
                'stop':'<|im_end|>"'}
            start=time.time()   
            resp = requests.post("http://127.0.0.1:8080/v1/chat/completions",
            headers={"Content-Type": "application/json"},
            json=payload) 
            print(f'Time needed {time.time()-start}') 
            data = resp.json()
            return data["choices"][0]["message"]["content"].strip()
        
    def transfer_style(self,sf_author,sf_song_title,st_author,st_song_text,st_song_title): 
        #self,sf_author,sf_song_title):
        selected=self.get_present_styles_for_song(sf_song_title,sf_author)
        print(selected)
        return self.apply_styles_all_at_once(styles=selected,st_song_text=st_song_text)
    def extract_style_from_all_songs(self, songs_csv, output_filename="extracted_styles_1.csv", save_every=20):    
        if not os.path.exists(songs_csv):
            raise FileNotFoundError(f"CSV file not found: {songs_csv}")
        sample_songs = pd.read_csv(songs_csv)
        print(f"üìÑ Loaded {len(sample_songs)} songs from {songs_csv}")

        
        script_dir = os.path.dirname(os.path.abspath(__file__))
        output_path = os.path.join(script_dir, output_filename)
        
        if os.path.exists(output_path):
            existing_df = pd.read_csv(output_path)
            processed = set(zip(
                existing_df["author"],
                existing_df["song"],
                existing_df["style_feature_category"]
            ))
            print(f"üîÅ Found existing file with {len(processed)} processed entries. Resuming...")
            file_exists = True
        else:
            processed = set()
            file_exists = False
            print("üÜï No existing file found. Starting fresh.")

        buffer = []
        total_time = 0.0
        counter = 0

        total_items = len(sample_songs) * len(self.styles_map)
        pbar = tqdm(total=total_items, desc="Extracting styles", ncols=100)

        for _, row in sample_songs.iterrows():
            author = row["author"]
            song = row["song_title"]
            

            for category, definition in self.styles_map.items():
                key = (author, song, category)
                if key in processed:
                    pbar.update(1)
                    continue

                start_time = time.time()
                try:
                    extracted_text = self.extract_style_from_song(song, category, definition)
                except Exception as e:
                    print(f"‚ùå Error processing {key}: {e}")
                    pbar.update(1)
                    continue

                time_needed = time.time() - start_time
                total_time += time_needed

                buffer.append({
                    "author": author,
                    "song": song,
                    "style_feature_category": category,
                    "extracted_text": extracted_text,
                    "time_needed": time_needed
                })
                processed.add(key)
                counter += 1
                pbar.update(1)

                
                if counter % save_every == 0:
                    pd.DataFrame(buffer).to_csv(output_path, mode="a", index=False, header=not file_exists)
                    file_exists = True
                    buffer = []
                    print(f"üíæ Progress saved ({counter} items processed so far).")

        
        if buffer:
            pd.DataFrame(buffer).to_csv(output_path, mode="a", index=False, header=not file_exists)
            print("üíæ Final save completed.")

        pbar.close()
        print(f"\nüèÅ Extraction complete. Total time: {total_time:.2f}s")  
            
test=StyleTransfer()


test.extract_style_from_all_songs(
    songs_csv="classification/cleaned_songs.csv",
    save_every=20  
)
 